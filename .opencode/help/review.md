# /review - 代码审查

## 描述

执行 AI 代码审查，从安全性、性能、代码质量等维度检查代码。

## 前置条件

- **测试通过**：test-report.md 存在且通过率达到标准

## 参考学习

使用全局技能 `requesting-code-review` 学习代码审查最佳实践

## 工作流程

```
用户输入 /review
  ↓
主控检测测试是否已通过
  ↓
扫描代码结构
  ↓
从多个维度审查代码
  ↓
生成审查报告
```

## 审查维度

| 维度 | 检查项 |
|------|--------|
| **安全性** | SQL 注入、XSS、CSRF、敏感信息泄露 |
| **性能** | 内存泄漏、N+1 查询、资源释放 |
| **代码质量** | 命名规范、代码重复、函数复杂度 |
| **最佳实践** | 错误处理、日志记录、配置管理 |
| **规范遵循** | 代码风格、lint 规则 |

## 问题严重程度

| 等级 | 描述 | 处理要求 |
|------|------|----------|
| Critical | 严重问题，可能导致系统崩溃或安全漏洞 | 必须在部署前修复 |
| Major | 重要问题，影响系统功能或性能 | 建议在本次迭代修复 |
| Minor | 一般问题，不影响功能但不符合规范 | 可在后续迭代修复 |
| Info | 信息性建议，仅供参考 | 可忽略 |

## 审查报告概览

```
## 问题汇总

### Critical（1 个）
1. SQL 注入漏洞 - src/services/user.service.ts:45

### Major（3 个）
2. 敏感信息硬编码 - src/config/api.ts:12
3. N+1 查询问题 - src/services/order.service.ts:78
4. 错误处理不完善 - src/utils/upload.ts:23

## 总体评估
通过条件：Critical 问题全部修复，Major 问题修复 50% 以上
当前状态：⚠️ 需要修复 Critical 问题后才能部署
```

## 相关指令

| 指令 | 描述 | 关系 |
|------|------|------|
| `/test` | 单元测试 | 前置步骤 |
| `/deploy` | 部署上线 | 下一步 |

## 后续操作

审查完成后：
1. **通过**：使用 `/deploy` 部署
2. **未通过**：修复问题后重新审查

## 示例

**用户**："代码审查"

**AI**：
```
正在执行代码审查...
✓ 代码结构扫描完成
✓ 安全性检查完成
✓ 性能检查完成
✓ 代码质量检查完成

┌─────────────────────────────────────────────────────────────┐
│  代码审查报告                    审查时间：2024-01-15 15:00:00│
├─────────────────────────────────────────────────────────────┤
│  总问题数：12                                             │
│  Critical：1    Major：3    Minor：5    Info：3            │
│  代码质量评分：85/100                                    │
└─────────────────────────────────────────────────────────────┘

⚠️ 需要修复 Critical 问题后才能部署

建议：
1. 修复 SQL 注入漏洞（Critical）
2. 修复至少 2 个 Major 问题
3. 修复后重新执行 /review
```
