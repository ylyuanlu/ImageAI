# /hotfix - 热修复

## 描述

热修复快速通道，用于紧急修复生产环境问题（紧急bug、安全漏洞、关键功能故障）。

## 前置条件

- **触发条件**：生产环境紧急问题
- **适用场景**：
  - 生产环境紧急bug
  - 安全漏洞修复
  - 关键功能故障

## 输出

- **输出文件**：`HOTFIX-PROCEDURE.md`（记录修复过程）

## 使用场景

- 生产环境出现影响用户的严重问题
- 需要快速修复并部署
- 不适合走完整开发流程

## 工作流程

```
用户识别紧急问题
  ↓
输入 /hotfix
  ↓
主控检测热修复条件
  ↓
创建热修复分支
  ↓
快速修复问题
  ↓
/quick-review（简化审查）
  ↓
/deploy（快速部署）
  ↓
验证修复效果
  ↓
事后补充完整文档
  ↓
合并回主分支
```

## 限制条件

- 仅修复单个问题
- 不引入新功能
- 必须有基本测试验证
- 事后必须补充完整文档

## 简化审查

热修复模式下，代码审查简化为仅检查：
- **安全性**：是否有安全风险
- **关键Bug**：是否会引入新问题
- **影响范围**：是否影响现有功能

## 相关指令

| 指令 | 描述 | 关系 |
|------|------|------|
| `/review` | 完整代码审查 | 非热修复场景使用 |
| `/deploy` | 部署上线 | 修复后部署 |
| `/quick-review` | 简化审查 | 热修复专用 |

## 后续操作

热修复完成后，建议：
1. 验证修复效果
2. 事后补充完整文档（HOTFIX-PROCEDURE.md）
3. 将修复同步到开发分支
4. 补充回归测试

## 禁止操作

- ❌ 引入新功能
- ❌ 大规模重构
- ❌ 修改配置文件（除非必要）
- ❌ 跳过所有验证

## 示例

**用户**："生产环境出错了，用户无法登录"

**AI**：
```
检测到紧急问题...

热修复条件满足：
- 生产环境紧急bug ✓
- 可快速修复 ✓

开始热修复流程：
1. 创建热修复分支
2. 快速定位问题
3. 简化代码审查
4. 快速部署验证

请描述问题现象：
```

**用户**："数据库连接池耗尽，导致登录失败"

**AI**：
```
问题已记录：数据库连接池耗尽

正在创建热修复分支...
✓ 分支：hotfix/fix-connection-pool

快速修复中...
✓ 修复：增加连接池配置，优化连接管理

建议的修复代码：
```javascript
// 优化连接池配置
const pool = new Pool({
  max: 20,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});
```

是否应用此修复？ [Y/n]
```

## 注意事项

热修复是**紧急措施**，修复后必须：
- ✅ 事后补充根因分析
- ✅ 补充完整的测试用例
- ✅ 同步到开发分支
- ✅ 考虑长期解决方案

## 个人开发者模式

热修复在个人开发者模式下进一步简化：
- 简化审查（仅安全性+关键Bug）
- 快速部署验证
- 事后文档补充

配置项：`skipReviewOnHotfix: true`
